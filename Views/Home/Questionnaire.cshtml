
@{
    ViewBag.Title = "Questionnaire";
    Layout = "~/Views/Shared/_Layout.cshtml";
}



    <div class="jumbotronmodify container" style="border:1px solid #234821" >
        <div id="wrapper">
            <div id="header">
                <h3>Know about OLDs, symptoms and your condition with this questionnaire.</h3>
            </div>
            <div id="recommendations" style="display:none">
                <h3>These are few of the suggested links-</h3>
            </div>
            <br />
            <br />

            <form id="quiz">
                <!-- Question 1 -->

                <h5 class="question">Choose your industry</h5>

                <!-- Here are the choices for the first question. Each input tag must have the same name. For this question, the name is q1. -->
                <!-- The value is which answer the choice corresponds to. -->
                <label>
                    <input type="radio" name="Industry" value="Manufacturing">
                    Manufacturing
                </label><br />
                <label>
                    <input type="radio" name="Industry" value="Mining">
                    Mining
                </label><br />
                <label>
                    <input type="radio" name="Industry" value="Construction">
                    Construction
                </label><hr />


                <!-- Question 2 -->
                <h5 class="question">Do you have any of these symptoms?</h5>
                <!-- Here are the choices for the second question. Notice how each input tag has the same name (q2), but a different name than the previous question. -->
                <label>
                    <input type="checkbox" name="Symptoms" value="Chest Pain">
                    Chest Pain
                </label><br />
                <label>
                    <input type="checkbox" name="Symptoms" value="Wheezing">
                    Wheezing
                </label><br />
                <label>
                    <input type="checkbox" name="Symptoms" value="Coughing">
                    Coughing
                </label><br />
                <label>
                    <input type="checkbox" name="Symptoms" value="Shortness of breath">
                    Shortness of breath
                </label><br />
                <label>
                    <input type="checkbox" name="Symptoms" value="Weight Loss">
                    Weight Loss
                </label><br />
                <label>
                    <input type="checkbox" name="Symptoms" value="Persistent Cough">
                    Persistent Cough
                </label><hr />


                <!-- Question 3 -->
                <h5 class="question">Do your symptoms get better when you are away from work ?</h5>
                <!-- Choices for the third question -->
                <label>
                    <input type="radio" name="Condition" value="Yes">
                    Yes
                </label><br />
                <label>
                    <input type="radio" name="Condition" value="No">
                    No
                </label><br />
                <label>
                    <input type="radio" name="Condition" value="Not Applicable">
                    Not Applicable
                </label><hr />


                <!-- Question 4 -->
                <h5 class="question">How long have you been working in the industry?</h5>
                <!-- Choices for the fourth question -->
                <label>
                    <input type="radio" name="q4" value="less than 1 year">
                    less than 1 year
                </label><br />
                <label>
                    <input type="radio" name="q4" value="1-5 years">
                    1-5 years
                </label><br />
                <label>
                    <input type="radio" name="q4" value="6-10 years">
                    6-10 years
                </label><br />
                <label>
                    <input type="radio" name="q4" value="10-20 years">
                    10-20 years
                </label><br />
                <label>
                    <input type="radio" name="q5" value="20+ years">
                    20+ years
                </label><hr />


                <h5 class="question">Do you smoke?</h5>
                <!-- Choices for the third question -->
                <label>
                    <input type="radio" name="Smoke" value="Yes">
                    Yes
                </label><br />
                <label>
                    <input type="radio" name="Smoke" value="No">
                    No
                </label><hr />

                <br />


                <button type="submit" id="submit" onclick="tabulateAnswers()" class="btn btn-primary">Submit</button>
                <button type="reset" id="reset" class="btn btn-primary">Reset</button>
            </form>



            <div class="row justify-content-center">

                <div class="col-lg-12 col-md-12">
                    <div id="answer"></div>
                </div>


            </div>
            <br />
            <br />



            <div class="card-deck" >
                <div class="card bg-warning mb-3 text-dark" style="display:none" id="years">


                    <div class="card-body">
                        <h4 class="alert-heading">Warning!</h4>
                        <p class="mb-0" id="years_text"></p>

                    </div>
                </div>
                <div class="card bg-warning mb-3 text-dark" style="display:none" id="smoker">


                    <div class="card-body">
                        <h4 class="alert-heading">Smoking is the biggest risk factor for lung conditions like COPD and Lung Cancer!</h4>
                        <p class="mb-0">If you smoke you will be at a higher risk of developing a lung condition. </p>

                    </div>
                </div>
                <div class="card bg-warning mb-3 text-dark" style="display:none" id="old">


                    <div class="card-body">
                        <h4 class="alert-heading">Work-related symptoms</h4>
                        <p class="mb-0">Generally, if your symptoms get better when you are away from work then chances of Occupational Lung Diseases should be considered.</p>

                    </div>
                </div>
            </div>


            <br />

            <div class="row align-items-center">



                <div class="col-lg-9 col-md-12" id="image" style="display:none">
                    <h5>General Preventive Measures for healthy Lungs</h5>
                    <img src="~/Images/preventive.png" alt="">
                </div>

            </div>




        </div>
        </div>

        <script>
            function tabulateAnswers() {
                event.preventDefault();
                var array = [];
                var diseases = ["Asthma", "LungCancer", "COPD", "Pneumoconiosis", "Mesothelioma", "Silicosis", "Asbestosis"];
                 var urls = ['/Home/Asthma', '/Home/LungCancer', '/Home/COPD', '/Home/Pneumoconiosis', '/Home/Mesothelioma', '/Home/Silicosis', '/Home/Asbestosis'];
                var symptoms = [["Shortness of breath", "Chest Pain", "Wheezing", "Coughing", "Sneezing", "Runny nose and eyes", "Manufacturing", "Construction"],
                ["Shortness of breath", "Chest Pain", "Weight Loss", "Persistent Cough", "Coughing Blood", "Hoarse Voice", "Tiredness", "Construction", "Manufacturing", "Mining"],
                ["Shortness of breath", "Wheezing", "Weight Loss", "Tiredness", "Coughing", "Construction", "Mining", "Manufacturing"],
                ["Shortness of breath", "Phelgm", "Chest Pain", "Coughing", "Mining"],
                ["Shortness of breath", "Persistent Cough", "Chest Pain", "Excessive Sweating", "Loss of Energy", "Construction", "Manufacturing"],
                ["Shortness of breath", "Persistent Cough", "Chest Pain", "Weight loss", "Fatigue", "Sudden fever", "Mining", "Manufacturing", "Construction"],
                ["Shortness of breath", "Dry Cough", "Chest Pain", "Weight Loss", "Pulmonary Hypertension", "Construction", "Manufacturing"],
                ]

                var x = document.getElementById("smoker");
                var ans = document.getElementById("answer");
                var quiz = document.getElementById("quiz");
                var image = document.getElementById("image");
                 var years = document.getElementById("years");
                var choices = document.getElementsByTagName('input');
                var head = document.getElementById('header');
                 var recom = document.getElementById('recommendations');
                var disease = [];
                var IndustryName;
                for (i = 0; i < choices.length; i++) {

                    if (choices[i].checked && choices[i].name == 'Industry') {

                        array.push(choices[i].value);
                    }
                    if (choices[i].checked && choices[i].name == 'Symptoms') {

                        array.push(choices[i].value);
                    }
                    if (choices[i].checked && choices[i].name == 'Smoke' && choices[i].value == 'Yes') {

                        x.style.display = "block";
                    }
                    if (choices[i].checked && choices[i].name == 'q4')
                    {
                        if (choices[i].value == '10-20 years' || choices[i].value == '20+years') {
                            years.style.display = "block";
                            document.getElementById("years_text").innerHTML = "You have been working in an industry for a long time. It is advised for you to get a medical checkup done.";
                        }
                        else if (choices[i].value == '1-5 years' || choices[i].value == 'less than 1 year') {
                            years.style.display = "block";
                            document.getElementById("years_text").innerHTML = "As you have recently joined the industry, it is advised that you take preventive measures to save your lungs from damage.";

                        }
                        else {
                             years.style.display = "block";
                            document.getElementById("years_text").innerHTML = "As you have been in the industry for more than 5 years, it is advised for you to take frequent medical checkups as some of the OLDs remain asymptomatic for many years after the first exposure.";

                        }
                        
                    }
                   if (choices[i].checked && choices[i].name == 'Condition' && choices[i].value == 'Yes')
                    {

                       document.getElementById("old").style.display = "block";
                    }
                }
                image.style.display = "block";
                quiz.style.display = "none";
                head.style.display = "none";
                recom.style.display = "block";

                for (i = 0; i < symptoms.length; i++) {

                    for (y = 1; y < array.length; y++) {

                        if (symptoms[i].includes(array[0])) {
                            if (symptoms[i].includes(array[y])){
                                disease.push(urls[i])

                            }

                        }

                    }

                }

                for ( i = 0; i < disease.length; i++) {

                        var a = document.createElement('a');
                        a.target = '_blank';
                    a.href = urls[i];
                    a.innerText = urls[i].split("/")[2];
                    a.type = "button";
                    a.className = "btn btn-primary";

                    ans.append(a);
                    ans.append("            ");

                        // $("#answer").append("<a type=button href=# class='btn btn-primary'>" +
                        //  response.list[i]+ "</a>");
                        //  }


                }
                
                        var a = document.createElement('a');
                        a.target = '_blank';
                a.href = '/Home/' + array[0];
                a.innerText =  array[0];
                    a.type = "button";
                    a.className = "btn btn-primary";
                ans.append(a);



            }
         
            @*$('#quiz').on('submit', function (event) {
                event.preventDefault();
                var answerbox = document.getElementById('answer');
                var array = [];
                $("input:checked").each(function () {

                    if (this.name === 'Symptoms') {


                        array.push(this.value);
                    }
                    if (this.name === 'Industry') {


                        array.push(this.value);
                    }
                    if (this.name === 'Smoke') {
                        $('#smoker').show();
                    } 

                });
        
       
        $.ajax({
            type: 'POST',
            dataType: 'json',
            url: '@Url.Action("Question", "Questions")',
            data: { 'data': array },
            success: function (response) {
                if (response.list) {
                    for (let i = 0; i < response.list.length; i++) {

                        var link = $("<a>");
                        link.attr("href", "~/Home/"+response.list[i]);
                        link.text(response.list[i]);
                        link.attr("target","_blank")
                        //link.type("button");
                        link.addClass("btn btn-primary");

                        $("#answer").append(link);


                        // $("#answer").append("<a type=button href=# class='btn btn-primary'>" +
                        //  response.list[i]+ "</a>");
                        //  }


                    }
                   $('#image').show();
                    alert('yes');

                }*@
            
    


        // $.get('/QuestionsController/Question', {'data':array}, function (response) {
        // console.log(response);
        // if(response.list) //same result variable we are returning from controller.
        //{
        //     // Let the user download the file he/she requested
        //     console.log("hi");
        //} else {
        //     alert("There is no file assigned to this employee.");
        //     }
  




        </script>
